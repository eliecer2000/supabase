version: 1.0
runtime: nodejs22
build:
  commands:
    pre-build:
      - echo "Installing pnpm and dependencies..."
      - npm install -g pnpm@9
      - pnpm install --frozen-lockfile
      - echo "Creating environment file..."
      - mkdir -p apps/studio
    build:
      - export NODE_OPTIONS="--max-old-space-size=65536"
      - cd apps/studio
      - npm run build
      - cd ..
      - cd ..    
  env:
    - name: MY_VAR_EXAMPLE
      value: "example"
run:
  runtime-version: 22.14.0
  command: node .next/standalone/apps/studio/server.js
  network:
    port: 8000
    env: APP_PORT
  env:
    - name: MY_VAR_EXAMPLE
      value: "example"
